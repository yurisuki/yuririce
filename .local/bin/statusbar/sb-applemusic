#!/bin/sh

# Check if `apple-music-electron` is running, if not stop the script.
pidof -x apple-music-electron >/dev/null 2>&1 || exit

# Some eval variables to make my work easier.
metadata() { playerctl metadata ;} # This one shows metadata about song that's played.
artist() { metadata | grep artist | sed -e 's/^.*artist//' | sed -e 's/^[ \t]*//' ;} # Grep only artist from metadata.
track() { metadata | grep title | sed -e 's/^.*title//' | sed -e 's/^[ \t]*//' ;} # Grep only track from metadata.
refresh() { pkill -SIGRTMIN+10 i3blocks ;} # Refresh i3blocks.

# If music is paused, make variable pause.
if [ $(playerctl status) = "Paused" ]; then
	pause="‚è∏ "
	colouring="\\n\\n#AAAAAA"
fi

# This one is being showed on the bar.
echo -e "$pause$(artist) - $(track)$colouring"

# Mouse buttons
case $BLOCK_BUTTON in
	1) apple-music-electron ;; # Left mouse button, opens `apple-music-electron`
	2) playerctl play-pause & refresh ;; # Toggle play/pause
	3) notify-send "" ; notify-send "üéµ Music module" "\- Shows apple-music-electron song playing.
- ‚è∏ when paused.
- Left click opens apple-music-electron.
- Middle click pauses.
- Scroll changes track." & refresh ;; # Show notifications with some informations about this block.
	4) playerctl previous & refresh ;; # Scroll up (plays previous song)
	5) playerctl next & refresh ;; # Scroll down (plays next song)
esac
